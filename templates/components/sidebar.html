{% load static %}

<aside id="sidebar" class="expand">
    <div class="d-flex">
        <button class="toggle-btn" type="button">
            <i class="lni lni-grid-alt"></i>
        </button>

        <div class="sidebar-logo">
            <a href="{% url 'tarefas:redirect_after_login' %}">Sistema SIGA</a>
        </div>
    </div>

    <ul class="sidebar-nav">
        {% if is_coordenador %}
        <li class="sidebar-item">
            <a href="{% url 'tarefas:dashboard_coordenador' %}" class="sidebar-link">
                <i class="fas fa-home"></i>
                <span>Página Inicial</span>
            </a>
        </li>

        <li class="sidebar-item">
            <a href="{% url 'importar_csv:importar_csv' %}" class="sidebar-link">
                <i class="fas fa-file-upload"></i>
                <span>Importar Tarefas</span>
            </a>
        </li>

        <li class="sidebar-item">
            <a href="{% url 'tarefas:lista_tarefas' %}" class="sidebar-link">
                <i class="fas fa-list"></i>
                <span>Ver Tarefas</span>
            </a>
        </li>

        <li class="sidebar-item">
            <a href="{% url 'tarefas:lista_servidores' %}" class="sidebar-link">
                <i class="fas fa-users"></i>
                <span>Ver Servidores</span>
            </a>
        </li>

        <li class="sidebar-item">
            <a href="#" class="sidebar-link collapsed" data-bs-toggle="collapse" data-bs-target="#reports"
                aria-expanded="false" aria-controls="reports">
                <i class="fas fa-chart-bar"></i>
                <span>Relatórios</span>
            </a>
            <ul id="reports" class="sidebar-dropdown list-unstyled collapse" data-bs-parent="#sidebar">
                <li class="sidebar-item">
                    <a href="{% url 'tarefas:relatorio_justificativas_coordenador' %}" class="sidebar-link">
                        <i class="fas fa-file-alt me-2"></i> Rel. Justificativas
                    </a>
                </li>
                <li class="sidebar-item">
                    <a href="{% url 'tarefas:relatorio_solicitacoes_coordenador' %}" class="sidebar-link">
                        <i class="fas fa-chart-pie me-2"></i> Rel. Solicitações
                    </a>
                </li>
            </ul>
        </li>

        <li class="sidebar-item">
            <a href="#" class="sidebar-link collapsed" data-bs-toggle="collapse" data-bs-target="#admin"
                aria-expanded="false" aria-controls="admin">
                <i class="fas fa-users-cog"></i>
                <span>Administração</span>
            </a>
            <ul id="admin" class="sidebar-dropdown list-unstyled collapse" data-bs-parent="#sidebar">
                <li class="sidebar-item">
                    <a href="/admin/usuarios/customuser/" class="sidebar-link">
                        <i class="fas fa-user-edit me-2"></i> Gerenciar Usuários
                    </a>
                </li>
                <li class="sidebar-item">
                    <a href="/admin/usuarios/historicobloqueio/" class="sidebar-link">
                        <i class="fas fa-history me-2"></i> Histórico Bloqueios
                    </a>
                </li>
            </ul>
        </li>
        {% endif %}

        {% if is_equipe_volante %}
        <li class="sidebar-item">
            <a href="{% url 'tarefas:painel_equipe_volante' %}" class="sidebar-link">
                <i class="fas fa-home"></i>
                <span>Página Inicial</span>
            </a>
        </li>
        <li class="sidebar-item">
            <a href="{% url 'tarefas:lista_justificativas_analise' %}" class="sidebar-link">
                <i class="fas fa-clipboard-list"></i>
                <span>Analisar Justificativas</span>
            </a>
        </li>
        <li class="sidebar-item">
            <a href="{% url 'tarefas:lista_solicitacoes_ajuda' %}" class="sidebar-link">
                <i class="fas fa-hands-helping"></i>
                <span>Solicitações de Ajuda</span>
            </a>
        </li>
        {% endif %}

        {% if is_servidor %}
        <li class="sidebar-item">
            <a href="{% url 'tarefas:detalhe_servidor' user.siape %}" class="sidebar-link">
                <i class="fas fa-home"></i>
                <span>Página Inicial</span>
            </a>
        </li>
        <li class="sidebar-item">
            <a href="{% url 'tarefas:minhas_justificativas' %}" class="sidebar-link">
                <i class="fas fa-file-alt"></i>
                <span>Minhas Justificativas</span>
            </a>
        </li>
        <li class="sidebar-item">
            <a href="{% url 'tarefas:minhas_solicitacoes' %}" class="sidebar-link">
                <i class="fas fa-hands-helping"></i>
                <span>Minhas Solicitações</span>
            </a>
        </li>
        {% endif %}

        {% if is_coordenador %}
        <li class="sidebar-item">
            <a href="{% url 'tarefas:configuracoes' %}" class="sidebar-link">
                <i class="fas fa-cog"></i>
                <span>Configurações</span>
            </a>
        </li>
        {% endif %}

        <li class="sidebar-item">
            <a href="#" class="sidebar-link">
                <i class="fas fa-question-circle"></i>
                <span>Ajuda</span>
            </a>
        </li>
    </ul>

    <div class="sidebar-footer">
        <a href="#" class="sidebar-link" data-bs-toggle="modal" data-bs-target="#logoutModal">
            <i class="lni lni-exit"></i>
            <span>Logout</span>
        </a>
    </div>
</aside>


<script>
document.addEventListener("DOMContentLoaded", function() {
    const sidebar = document.getElementById('sidebar');
    const toggleBtn = document.querySelector('.toggle-btn');

    // Carregar o estado inicial da sidebar do sessionStorage
    const isExpanded = sessionStorage.getItem('sidebarExpanded');

    // Se não houver valor salvo, expande por padrão
    if (isExpanded === null || isExpanded === 'true') {
        sidebar.classList.add('expand');
    } else {
        sidebar.classList.remove('expand');
    }

    // Toggle ao clicar no botão
    if (toggleBtn) {
        toggleBtn.addEventListener('click', function() {
            sidebar.classList.toggle('expand');

            // Salvar o estado no sessionStorage
            const isExpanded = sidebar.classList.contains('expand');
            sessionStorage.setItem('sidebarExpanded', isExpanded);
        });
    }
});
</script>
